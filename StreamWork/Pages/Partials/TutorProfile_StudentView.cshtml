@model StreamWork.Pages.Profile.Tutor
@{var cacheRand = new Random().Next();}

<div class="tab-content">
    <div class="tab-pane active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
        <div class="container-fluid pt-3" style="width:100%">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-12">
                    <div class="card">
                        <div class="card-title p-3 mb-0">
                            <p class="form-header d-inline-block mb-0" style="font-size:18px">Basic Information</p>
                        </div>
                        <div class="card-body">
                            <div class="row pr-4 pl-4 pt-0">
                                <div class="col-lg-3">
                                    <div class="card border-0 rounded-0 text-center">
                                        @if (Model.UserProfile.College == null)
                                        {
                                            <div>
                                                <input type="image" src="~/images/TutorAssets/TutorDashboard/DefaultUniversity.png" class="form-control border-0 rounded-0 d-block mr-auto ml-auto pt-3" style="width:130px; height:100%">
                                            </div>
                                        }
                                        else
                                        {
                                            var college = Model.UserProfile.College.Split('|');
                                            if (college.Length > 1)
                                            {
                                                <p id="university-abbreviation" class="form-header pt-4 pl-2 pr-2" style="font-size:20px">@college[0]</p>
                                                <p id="university-name" class="form-header" style="font-size:14px">@college[1]</p>
                                            }
                                            else
                                            {
                                                <p id="university-abbreviation" class="form-header pt-4 pl-2 pr-2" style="font-size:20px">@college[0]</p>
                                            }
                                        }
                                    </div>

                                </div>
                                @if (Model.Sections != null && Model.Sections.Count > 1)
                                {
                                    <div class="form-group col-lg-9 p-4">
                                        <p class="form-header" style="font-size: 16px">@Model.Sections[1].SectionTitle</p>
                                        <p style="font-size: 14px">@Model.Sections[1].SectionDescription</p>
                                    </div>
                                    if (Model.Sections.Count > 2)
                                    {
                                        for (int i = 2; i < Model.Sections.Count; i++)
                                        {
                                            <div class="divider"></div>
                                            <div class="form-group col-lg-12 p-4">
                                                <p class="form-header" style="font-size: 16px">@Model.Sections[i].SectionTitle</p>
                                                <p style="font-size: 14px">@Model.Sections[i].SectionDescription</p>
                                            </div>
                                        }
                                    }
                                }
                                else
                                {
                                    <div class="col-9 p-3" style="height:200px">
                                        <p class="form-sub-header p-0" style="font-size:22px">Welcome To My Tutor Profile!</p>
                                        <p class="form-sub-header p-0" style="font-size:14px; font-family:'Roboto', serif">This tutor hasn't filled out any information about themselves yet!</p>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="tab-pane" id="schedule" role="tabpanel" aria-labelledby="schedule-tab">
        <div class="container-fluid pt-3" style="width:100%">
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-title p-3 mb-0 form-header" style="font-size:18px">Stream Schedule</div>
                        <div class="card-body">
                            <div class="row pr-4 pl-4 pt-0" id="taskRow">
                                @if (Model.Schedule.Count > 0)
                                {
                                    @foreach (var task in Model.Schedule)
                                    {
                                        <div class="col-lg-12 col-md-12 mt-2 w-100">
                                            <div class="card border-0">
                                                <div class="card-body">
                                                    <div class="d-inline-flex">
                                                        <img class="rounded m-1 schedule-image" src="@task.SubjectThumbnail" />
                                                        <div class="text-center m-1 schedule-image schedule-border">
                                                            <p class="form-header schedule-month">@task.Date.ToString("MMM")</p>
                                                        </div>
                                                        <div class="text-center m-1 schedule-image schedule-border">
                                                            <p class="form-header schedule-day">@task.Date.Day</p>
                                                            <p class="form-header schedule-dow">@task.Date.ToString("ddd")</p>
                                                        </div>
                                                        <div class="m-1" style="height:75px;">
                                                            <p class="form-header m-0">@task.StreamTitle</p>
                                                            <p class="mt-1 mb-0" style="font-size:10px">@task.StreamSubject</p>
                                                            <p class="schedule-time">@task.TimeStart - @task.TimeStop [@task.TimeZone.ToString()]</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                                else
                                {
                                    <div class="col-12 p-3" style="height:200px">
                                        <p class="form-sub-header p-0" style="font-size:22px">Nothing on the schedule!</p>
                                        <p class="form-sub-header p-0" style="font-size:14px; font-family:'Roboto', serif">This tutor hasn't scheduled their streams yet!</p>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="tab-pane" id="stream" role="tabpanel" aria-labelledby="stream-tab">
        <div class="container-fluid pt-2" style="width:100%">
            <div class="row p-3">
                <div class="col-12">
                    <form class="p-1 border rounded" style="background-color:white" onkeyup="SearchStreams(event, '@Model.UserProfile.Name', '@Model.UserProfile.Username', 'col-lg-6')" onsubmit="SearchStreams(event, '@Model.UserProfile.Name', '@Model.UserProfile.Username', 'col-lg-6')">
                        <input id="searchQuery" class="form-control-lg" type="search" placeholder="🔎 Search Past Streams" style="border: none; font-size:12px;">
                    </form>
                    <select id="filter" name="filter" class="form-control form-control-sm rounded-0 mt-3" onchange="SearchStreams(event, '@Model.UserProfile.Name', '@Model.UserProfile.Username')" style="width:175px">
                        <option value="">Filter</option>
                        <option value="Mathematics">Mathematics</option>
                        <option value="Science">Science</option>
                        <option value="Engineering">Engineering</option>
                        <option value="Business">Business</option>
                        <option value="Law">Law</option>
                        <option value="Art">Art</option>
                        <option value="Humanities">Humanities</option>
                        <option value="Other">Others</option>
                    </select>
                </div>
            </div>
            <div class="divider"></div>
            <div id="stream-row" class="row p-3">
                @if (Model.UserArchivedStreams.Count != 0)
                {
                    @foreach (var streamInfo in Model.UserArchivedStreams)
                    {
                        <div class="col-lg-6 col-md-6 col-sm-6">
                            <div class="card mt-3 border-0" style="border-bottom-left-radius:20px; border-bottom-right-radius:20px; border-top-left-radius:20px; border-top-right-radius:20px">
                                <div class="card-title">
                                    <a href="../StreamViews/StreamPlaybackPage?streamId=@streamInfo.StreamID"><img asp-append-version="true" style="width:100%; height:100%; border-top-left-radius:20px; border-top-right-radius:20px;" src="@streamInfo.StreamThumbnail?@cacheRand"></a>
                                </div>
                                <div class="card-body pt-0 pb-1">
                                    <h5 class="text-truncate form-header">@streamInfo.StreamTitle</h5>
                                    <input type="hidden" value="@streamInfo.StreamDescription" />
                                    <p class="text-truncate form-header" style="font-size:10px">@Model.UserProfile.Name.Replace('|', ' ')</p>
                                </div>
                                <div class="card-footer" style="background-color:@streamInfo.StreamColor; border-bottom-left-radius:20px; border-bottom-right-radius:20px;"></div>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="col-12 text-center">
                        <p class="form-sub-header p-0" style="font-size:22px">No Streams</p>
                        <p class="form-sub-header p-0" style="font-size:14px; font-family:'Roboto', serif">This tutor hasn't streamed yet!</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>