@page
@model StreamWork.Pages.Tutor.TutorStream
@{Layout = "_LayoutTutorNavbar";}
@{ViewData["Title"] = "TutorStream";}
@Html.AntiForgeryToken()

@if (!Model.UserProfile.ProfileType.Equals("tutor") || !Model.UserProfile.AcceptedTutor)
{
    <script>$(document).ready(function () {
            $('#unapprovedTutorModal').modal({
                backdrop: 'static',
                keyboard: false
            })
        })</script>
}
else if (Model.UserChannel.StreamTitle == null && Model.UserChannel.StreamSubject == null)
{
    <script>$(document).ready(function () {
            OpenModal('registerStreamModal');
        });</script>
}

<div class="container-fluid">
    <div class="row row-style">
        <div id="stream" class="d-flex flex-column col-lg-8 col-md-12 col-sm-12 col-12 p-0" style="position:relative">
            <iframe style=" width:100%; height:100%;" class="p-0" src="https://c.streamhoster.com/embed/media/WxsdDM/mAe0epZsixC/@Model.UserChannel.ChannelKey.Split('|')[0]" frameborder="0" scrolling="no" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>
        </div>
        <div id="chatBox" class="d-flex flex-column col-lg-4 col-md-12 col-sm-12 col-12 p-0">
            <iframe style="height:100%; border:none;" src="http://localhost:58539/chat/chat?chatId=@Model.UserChannel.Username&chatInfo=@Model.ChatInfo"></iframe>
        </div>
    </div>
</div>

<div id="registerStreamModal" class="custom-modal">
    <div class="custom-modal-content">
        <h5 class="form-header" style="padding-left:20px; padding-top:10px; font-size:16px;">Stream Information</h5>
        <div class="slider">
            <div class="slider-object" style="width:160px"></div>
        </div>
        <div class="row">
            <div class="col-12">
                <form id="registerStreamForm" class="pt-4 pb-4 pl-5 pr-5">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-lg-6 col-md-6 col-sm-12 col-12 mt-2">
                                <label class="form-header">Stream Title</label>
                                <input class="form-control form-input mb-2 border" type="text" id="streamTitle" placeholder="ex: Calculus 2: Integrals" required>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-12 col-12 mt-2">
                                <label class="form-header">Stream Subject</label>
                                <select class="form-control form-input border" id="streamSubject">
                                    <option value="Select Subject">-Select-Subject-</option>
                                    <option value="Mathematics">Mathematics</option>
                                    <option value="Science">Science</option>
                                    <option value="Engineering">Engineering</option>
                                    <option value="Business">Business</option>
                                    <option value="Law">Law</option>
                                    <option value="Art">Art</option>
                                    <option value="Humanities">Humanities</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="col-12 pt-3">
                                <label class="form-header">Stream Description</label>
                                <textarea class="form-control form-textarea border" type="text" id="streamTitle" placeholder="ex: Today we are going to be learning about how to do integrals using U-Substitution" required></textarea>
                            </div>
                            <div class="col-lg-7 col-md-7 col-sm-12 col-12 pt-3">
                                <label class="form-header">Stream Thumbnail</label>
                                <div class="image-container mr-auto ml-auto">
                                    <img class="mt-1" id="previewStreamThumbnail" src="~/images/MathDefault.png" alt="your image" style="width:100%; border-radius:10px">
                                    <input id="addStreamThumbnail" type="image" class="bottom-right" src="~/images/TutorAssets/TutorDashboard/Upload.png" style="bottom:-5px" />
                                    <input name="uploadThumbnail" id="uploadThumbnail" class="d-none" type="file" value="~/images/MathDefault.png" onchange="readURL(this,'ThumbnailEdit');">
                                    <script>$("#addStreamThumbnail").click(function (e) {
                                            e.preventDefault()
                                            $("input[id='uploadThumbnail']").click();
                                        })</script>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <button id="GoLive" class="btn border-0 rounded-0 p-3 w-100" style="background-color:#004643; color:white" onclick="CheckIfStreamIsLive('@Model.UserChannel.ChannelKey', '@Model.UserChannel.Username', '@Model.ChatInfo')">Go Live!</button>
    </div>
</div>
