@page
@model StreamWork.Pages.Tutor.TutorStream
@{Layout = "Tutor/_LayoutTutor";}
@{ViewData["Title"] = "TutorStream";}
@Html.AntiForgeryToken()

@if (!Model.CurrentUserProfile.ProfileType.Equals("tutor") || !Model.CurrentUserProfile.AcceptedTutor)
{
    <script>
        $(document).ready(function () {
            $('#unapprovedTutorModal').modal({
                backdrop: 'static',
                keyboard: false
            })
        })
    </script>
}
else if (Model.UserChannel.StreamTitle == null && Model.UserChannel.StreamSubject == null)
{
    <script>
        $(document).ready(function () {
            OpenModal('register-stream-modal');
        });
    </script>
}

<div class="container-fluid">
    <div class="row" style="margin-top:71px">
        <div class="d-flex flex-column col-lg-9 col-md-12 col-sm-12 col-12 p-0 border-right ">
            <div id="player-card" class="card border-0">
                <iframe id="player" style="width:100%; height:calc(100vh - 71px)" src="https://c.streamhoster.com/embed/media/WxsdDM/mAe0epZsixC/@Model.UserChannel.ChannelKey.Split('|')[0]" frameborder="0" scrolling="no" allow="autoplay" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>
            </div>
        </div>
        <div id="chat-card" class="d-flex flex-column fixed archived-chats col-lg-3 col-md-12 col-sm-12 col-12 p-0 border-top-0">
            <iframe style="width:100%;height:100%; border:none;" src="http://localhost:58539/chat/LiveChat?chatId=@Model.UserChannel.Username&chatInfo=@Model.ChatInfo"></iframe>
        </div>
    </div>
</div>

<div id="register-stream-modal" class="custom-modal">
    <div class="custom-modal-content">
        <h5 class="form-header" style="padding-left:20px; padding-top:10px; font-size:16px;">Stream Information</h5>
        <div class="slider">
            <div class="slider-object" style="width:160px"></div>
        </div>
        <div class="row">

            <div class="col-12">
                <form id="register-stream-form" class="pt-4 pb-4 pl-5 pr-5">
                    <div id="tutor-stream-error-notification" class="alert notification-warning" style="padding-left:25px" role="alert">
                        <b>Are you sure you want to delete this stream?</b> This is a irreversible action.
                    </div>
                    <script>
                        $('#tutor-stream-error-notification').hide()
                    </script>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-lg-6 col-md-6 col-sm-12 col-12 mt-2">
                                <label class="form-header">Stream Title</label>
                                <input class="form-control form-input mb-2 border" type="text" id="stream-title" placeholder="ex: Calculus 2: Integrals" required>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-12 col-12 mt-2">
                                <label class="form-header">Stream Subject</label>
                                <select class="form-control form-input border" id="stream-subject" required>
                                    <option value="">-Select-Subject-</option>
                                    <option value="Mathematics">Mathematics</option>
                                    <option value="Science">Science</option>
                                    <option value="Engineering">Engineering</option>
                                    <option value="Business">Business</option>
                                    <option value="Law">Law</option>
                                    <option value="Art">Art</option>
                                    <option value="Humanities">Humanities</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="col-12 pt-3">
                                <label class="form-header">Stream Description</label>
                                <textarea class="form-control form-textarea border" type="text" id="stream-description" placeholder="ex: Today we are going to be learning about how to do integrals using U-Substitution" required></textarea>
                            </div>
                            <div class="col-lg-7 col-md-7 col-sm-12 col-12 pt-3">
                                <label class="form-header">Stream Thumbnail</label>
                                <div class="image-container mr-auto ml-auto">
                                    <img id="preview-stream-thumbnail" src="~/images/MathDefault.png" class="mt-1" style="width:100%; border-radius:10px">
                                    <input id="add-stream-thumbnail" type="image" src="~/images/TutorAssets/TutorDashboard/Upload.png" class="bottom-right" style="bottom:-5px" />
                                    <input id="upload-stream-thumbnail" type="file" class="d-none" value="~/images/MathDefault.png" onchange="ReadImageUrl(this,'preview-stream-thumbnail');">
                                    <script>
                                        $("#add-stream-thumbnail").click(function (e) {
                                            e.preventDefault()
                                            $("input[id='upload-stream-thumbnail']").click();
                                        })
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <button id="GoLive" class="btn border-0 rounded-0 p-3 w-100" style="background-color:#004643; color:white" onclick="IsLive('@Model.UserChannel.ChannelKey')">Go Live!</button>
    </div>
</div>

<script>
    ResizeStreamSection()
</script>