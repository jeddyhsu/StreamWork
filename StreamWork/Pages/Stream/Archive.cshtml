@page "{tutor}/{id}"
@model StreamWork.Pages.Stream.Archive
@{Layout = "Tutor/_LayoutTutor"; }
@{ViewData["Title"] = "StreamPlaybackPage";}
@{var cacheRand = new Random().Next();}

<div class="container-fluid">
    <div class="row" style="padding-top:58px">
        <div class="d-flex flex-column col-lg-8 col-md-12 col-sm-12 col-12 p-0 border-right ">
            <div class="card border-0">
                <div id="tutor-info" class="border-top pt-3 pl-3 pr-3 pb-1" style="background-color:#FBFBFB">
                    <div class="d-lg-inline-block d-md-inline-block d-sm-none d-none float-right mr-3">
                        @if (Model.FollowValue.Equals("Following"))
                        {<button id="Following" onclick="Unfollow('@Model.UserProfile.Id', '@Model.UserProfile.Id')" class="streamWork-primary m-1" style="width:150px;">Following</button>}
                        else if (Model.FollowValue.Equals("Follow"))
                        {<button id="Follow" onclick="Follow('@Model.UserProfile.Id', '@Model.UserProfile.Id')" class="streamWork-primary m-1" style="width:150px;">Follow</button>}
                        <button class="streamWork-orange m-1" style="width:150px;">Donate</button>
                        <!--
                            <button class="streamWork-secondary m-1" onclick="window.location.href='/Profile/Tutor/@Model.TutorUserProfile.Username'">Tutor Profile</button>
                        -->
                    </div>
                    <input align="left" type="image" class="rounded" style="width:30px" src=@Model.TutorUserProfile.ProfilePicture />
                    <h3 class="mb-0 form-header" style="font-size:20px; margin-left:40px; color:@Model.UserChannel.ChatColor">@Model.TutorUserProfile.Name.Replace('|', ' ')</h3>
                    <p class="form-sub-header mb-1" style="margin-left:40px; font-size:14px">@Model.TutorUserProfile.ProfileCaption</p>
                    <div class="d-lg-none d-md-none d-sm-inline-block d-inline-block">
                        @if (Model.FollowValue.Equals("Following"))
                        {<button id="Following" onclick="Unfollow('@Model.UserProfile.Id', '@Model.UserProfile.Id')" class="streamWork-primary mt-1" style="width:150px;">Following</button>}
                        else if (Model.FollowValue.Equals("Follow"))
                        {<button id="Follow" onclick="Follow('@Model.UserProfile.Id', '@Model.UserProfile.Id')" class="streamWork-primary mt-1" style="width:150px;">Follow</button>}
                        <button class="streamWork-orange m-1" style="width:150px;">Donate</button>
                        <!--

                        -->
                    </div>
                </div>
                <iframe id="player" style="width:100%;" src="https://c.streamhoster.com/embed/media/WxsdDM/mAe0epZsixC/@Model.ArchivedStream.StreamID" frameborder="0" scrolling="no" allow="autoplay" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>
                <div id="player-row" class="card-body p-0">
                    <img class="pr-3" align="left" src="/images/ChatAssets/Math.png" style="width:100%; height:100%; max-width:120px; max-height:110px; cursor:pointer" onclick="window.open('https://www.streamwork.live/Home/Search?s=@Model.UserChannel.StreamSubject&q=')" />
                    <div class="m-3" id="StreamInfo">
                        <h3 style="color:black; font-family:'Roboto Slab', serif;">@Model.ArchivedStream.StreamTitle<span></span></h3>
                        <p class="mb-1" style="padding-left:105px">@Model.ArchivedStream.StreamDescription</p>
                        <p style="font-size:12px; padding-left:105px">Tutoring @Model.ArchivedStream.StreamSubject</p>
                    </div>
                </div>
                <div class="card-body" style="background-color:#FBFBFB">
                    <p class="form-header" style="font-size:18px"><b>Other Recent Streams</b></p>
                    <div class="row">
                        @foreach (var stream in Model.OtherArchivedStreams)
                        {
                            <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6 col-12">
                                @await Html.PartialAsync("Partials/Stream/Stream_Appearance", stream)
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex flex-column fixed col-lg-4 col-md-12 col-sm-12 col-12 p-0 border-top-0" style="overflow:scroll !important">
            <div class="border-bottom border-top" style="height:70px; background-color:#FBFBFB">
                <p class="d-inline-block form-header p-3" style="font-size:20px">Bio</p>
                <button class="streamWork-secondary m-3 float-right" style="width:150px" onclick="window.location.href='/Profile/Tutor/@Model.TutorUserProfile.Username'">Tutor Profile</button>
            </div>
            <div style="background-color:white">
                <div>
                    <p class="d-inline-block form-header p-3 m-0" style="font-size:20px">About @Model.TutorUserProfile.Name.Replace('|', ' ')</p>
                </div>
                <div class="pl-3 pr-3">
                    <hr />
                </div>
                <div class="p-3">
                    @if (Model.TutorUserProfile.College == null)
                    {
                        <div>
                            <input type="image" src="~/images/TutorAssets/TutorDashboard/DefaultUniversity.png" class="form-control border-0 rounded-0 d-block mr-auto ml-auto pt-3" style="width:130px; height:100%">
                        </div>
                    }
                    else
                    {
                        var college = Model.TutorUserProfile.College.Split('|');
                        if (college.Length > 1)
                        {
                            <p id="university-abbreviation" class="form-header pl-2 pr-2" style="font-size:28px">@college[0]</p>
                            <p id="university-name" class="form-header pl-2 pr-2" style="font-size:20px">@college[1]</p>
                        }
                        else
                        {
                            <p id="university-abbreviation" class="form-header pl-2 pr-2" style="font-size:20px">@college[0]</p>
                        }
                    }
                </div>
                <div class="pl-3 pr-3">
                    <hr />
                </div>
                @if (Model.Sections != null && Model.Sections.Count > 1)
                {
                    <div class="form-group p-4">
                        <p class="form-header" style="font-size: 16px">@Model.Sections[1].SectionTitle</p>
                        <p style="font-size: 14px">@Model.Sections[1].SectionDescription</p>
                    </div>
                    if (Model.Sections.Count > 2)
                    {
                        for (int i = 2; i < Model.Sections.Count; i++)
                        {
                            <div class="pl-3 pr-3">
                                <hr />
                            </div>
                            <div class="form-group p-4">
                                <p class="form-header" style="font-size: 16px">@Model.Sections[i].SectionTitle</p>
                                <p style="font-size: 14px">@Model.Sections[i].SectionDescription</p>
                            </div>
                        }
                    }
                }
                else
                {
                    if (Model.UserProfile.Id == Model.TutorUserProfile.Id)
                    {
                        <div class="p-3" style="height:200px">
                            <p class="form-sub-header p-0" style="font-size:22px">No Info...yet!</p>
                            <p class="form-sub-header p-0" style="font-size:14px; font-family:'Roboto', serif">Help students know more about you and your background in education</p>
                            <button class="streamWork-primary mt-3" onclick="window.location.href ='/Tutor/TutorDashboard'" style="font-size:14px; font-family:'Roboto', serif">Edit Profile</button>
                        </div>
                    }
                    else
                    {
                        <div class="p-3" style="height:200px">
                            <p class="form-sub-header p-0" style="font-size:22px">Welcome To My Tutor Profile!</p>
                            <p class="form-sub-header p-0" style="font-size:14px; font-family:'Roboto', serif">This tutor hasn't filled out any information about themselves yet!</p>
                        </div>
                    }
                }
            </div>
        </div>
    </div>
</div>




<script>$(window).resize(function () {
        var height = $('#player-row').height();
        var tutorInfoHeight = $('#tutor-info').height();
        var offest = height + 58 + tutorInfoHeight + 21;
        $('#player').css('height', 'calc(100vh - ' + offest + 'px)')
        console.log("asdfsadasdf")
    })

    var height = $('#player-row').height();
    var tutorInfoHeight = $('#tutor-info').height();
    var offest = height + 58 + tutorInfoHeight + 21;
    $('#player').css('height', 'calc(100vh - ' + offest + 'px)')
    console.log("asdfsadasdf")</script>
