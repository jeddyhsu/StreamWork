@model StreamWork.ViewModels.ProfileTutorViewModel

@{
    ViewData["Title"] = "ProfileTutor";
}
<div>
    <div style="font-family:'Roboto', sans-serif;">
        <nav class="navbar sticky-top navbar-expand-lg  text-center" style="background-color:#008080">
            <img src="/images/WhiteStreamWork.png" width="250" height="70" onclick="window.location.href='/'">
            <button class="navbar-toggler" type="button" data-toggle="collapse" id="nav" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item ml-sm-5" style="font-size:14px;">
                        <a class="nav-link" href="/" style="color:white;">Browse by Subjects</a>
                    </li>
                    <li class="nav-item ml-sm-5" style="font-size:14px; ">
                        <a class="nav-link" href="/Home/BecomeTutor" style="color:white;">Become a Tutor</a>
                    </li>
                    <li class="nav-item ml-sm-5" style="font-size:14px;">
                        <a id="button" class="nav-link" href="/Home/About" style="color:white;">About</a>
                    </li>
                    <li class="nav-item ml-sm-5" style="font-size:14px;">
                        <a class="nav-link" href="/Home/HowToStream" style="color:white;">How to Stream</a>
                    </li>
                </ul>
            </div>
        </nav>
        <div class="container-fluid mt-3">
            <div class="row">   
                <nav class="col-md-3 d-none d-lg-block sidebar">
                    <div class="sidebar-sticky">
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <div class="card text-center mt-3 border-0" style="color:white;">
                                    <div class="card-body" style="background-color:#006565">
                                        <br />
                                        <br />
                                         <br />
                                        <img src="/images/RithvikArun.jpeg" style="width:50%; height:50%" />
                                        <h1 class="card-title mt-4" style=" font-size:1.8vw; color:lightgray"><b>@Model.userProfile.FirstName @Model.userProfile.LastName</b></h1>
                                        <p class="card-text" style="font-size:1vw; color:white">Calculus 2 / Geometrey / Limits</p>
                                        <p class="card-text" style="font-size:1vw; color:white">I am a math major at Arizona State Univeristy and work at Polytechnic Tutoring Center. </p>
                                        <hr />
                                        <h3 style="font-size:1.5vw; color:white">Current Stream</h3>
                                        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/live_stream?channel=@Model.userChannels[0].ChannelKeyAPI" frameborder="1"></iframe>
                                        <br />
                                        <br />
                                        @if(@Model.userChannels[0].VideoURL != null){
                                        <input align="middle" type="text" class="form-control" value="@Model.userChannels[0].VideoURL" id="streamURL" placeholder="Stream URL">
                                        }
                                        else{
                                        <input align="middle" type="text" class="form-control" id="streamURL" placeholder="Stream URL">
                                        }
                                        <br />
                                         @if(@Model.userChannels[0].StreamID != null){
                                              <input align="middle" type="text" class="form-control" value="@Model.userChannels[0].StreamTitle" id="streamTitle" placeholder="Stream Title">
                                        }
                                        else{
                                              <input align="middle" type="text" class="form-control" id="streamTitle" placeholder="Stream Title" />
                                        }
                                        <br />
                                          @if(@Model.userChannels[0].SubjectStreaming != null){
                                        <select style="width:100%" id="streamSubject">
                                            <option>@Model.userChannels[0].SubjectStreaming</option>
                                            <option value="Mathematics">Mathematics</option>
                                            <option value="Science">Science</option>
                                            <option value="Engineering">Engineering</option>
                                            <option value="Business">Business</option>
                                            <option value="Law">Law</option>
                                            <option value="Art">Art</option>
                                            <option value="Humanities">Humanities</option>
                                            <option value="Other">Other</option>
                                           
                                        </select>
                                          <br />
                                          <br />
                                          <button id="stopStream" type="button" class="btn btn-info btn-md" onclick="StopStream('stop')">Stop Stream</button>
                                        }
                                        else{
                                            <select style="width:100%" id="streamSubject">
                                                <option>Select Subject</option>
                                                <option value="Mathematics">Mathematics</option>
                                                <option value="Science">Science</option>
                                                <option value="Engineering">Engineering</option>
                                                <option value="Business">Business</option>
                                                <option value="Law">Law</option>
                                                <option value="Art">Art</option>
                                                <option value="Humanities">Humanities</option>
                                                <option value="Other">Other</option>
                                            </select>

                                        }

                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
                <div class="col-sm-12 col-md-12 col-lg-9 mt-3">
                    <h3>PAST LIVESTREAMS</h3>
                    <div class="row">
                        @foreach(var stream in Model.userArchivedVideos){
                        <div class="col-lg-4 col-md-6 mt-4">
                            <input type="image" width="100%" height="80%" src=@stream.StreamThumbnail onclick="window.location.href='../StreamViews/StreamPage?streamKey=' + ('@stream.StreamID');">
                            <h5 style="font-family: 'Roboto'">@stream.StreamTitle</h5>
                        </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="loadingPopup" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-body" style="align-items:center">
                <h2>Retrieving Stream From Youtube</h2>
                <div style="display:block;margin-left:auto;margin-right:auto;" class="lds-dual-ring"></div>
            </div>
        </div>
    </div>
</div>


<script>
$('select').on('change', function () {
        $.ajax({
            url: '/Home/ProfileTutor',
            type: 'post',
            dataType: 'json',
            data: {
                'streamURL': $('#streamURL').val(),
                'streamTitle': $('#streamTitle').val(),
                'streamSubject': $('#streamSubject').val()
            },
            success: function (data) {
               if (data.message === "Saved") {
                   location.reload()
                   alert("Boradcast has started")
               } 
           }
        });
    })

    </script>

<script>

   function StopStream(stop) {
       $.ajax({
           url: '/Home/ProfileTutor',
           type: 'post',
           dataType: 'json',
           data: {
               'Stop': stop
           },
           success: function (data) {
               if (data.message === "Stopped") {
                   location.reload()
                   alert("Your broadcast has stopped");
               } else {
                   alert("Broadcast Failed to Start");
               }
           }
       });
   }
</script>

<style>
    .dot {
        height: 10vw;
        width: 10vw;
        background-color: white;
        border-radius: 50%;
        text-align: center;
        color: black
    }

    .sidebar {
        height: 100%;
        width: 20%;
        position: fixed;
        z-index: 1;
        top: 0px;
        bottom: 0px;
        right: 0;
        overflow-y: scroll;
        background-color: #006565;
        overflow-x: hidden;
        color: white;
        text-align: center;
    }
    img {
        max-width: 460px;
        max-height : 250px;
    }

    input[type="file"] {
        display: none;
    }

    .custom-file-upload {
       
        display: inline-block;
        padding: 6px 12px;
        cursor: pointer;
    }
    
</style>


